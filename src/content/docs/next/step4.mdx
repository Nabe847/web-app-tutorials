---
title: '4: タスクの追加(Create)'
pubDate: 2025-06-10
description: 'Next.js の初心者向けチュートリアルです'
author: 'Nabe847'
image:
  url: 'https://docs.astro.build/assets/full-logo-light.png'
  alt: 'Astroのロゴ。'
tags: ['Next.js', 'tutorial']
---

## このステップで学ぶこと

前回のタスク表示機能に続いて、今回はタスクの追加機能を実装していきます。

まず、フォームの基本的な使い方と状態管理について学びます：
- フォームの値は状態で管理する
- 入力値の変更を検知して状態を更新する
- フォーム送信時に新しいタスクを追加する

### app/page.js を更新

タスク追加機能を実装します：

```javascript
'use client';
import { useState } from 'react';

export default function Home() {
  // 1. 状態の定義
  const [tasks, setTasks] = useState([
    { id: 1, title: '買い物に行く', completed: false },
    { id: 2, title: '宿題をする', completed: true },
    { id: 3, title: '友達に連絡する', completed: false },
  ]);
  const [newTaskTitle, setNewTaskTitle] = useState('');

  // 2. タスク追加の処理
  const handleAddTask = (e) => {
    e.preventDefault();
    if (!newTaskTitle.trim()) return;

    const newTask = {
      id: tasks.length + 1,
      title: newTaskTitle,
      completed: false,
    };

    setTasks([...tasks, newTask]);
    setNewTaskTitle('');
  };

  return (
    <div style={{ padding: '20px', maxWidth: '600px', margin: '0 auto' }}>
      <h1>タスク管理アプリ</h1>

      {/* 3. タスク追加フォーム */}
      <form onSubmit={handleAddTask} style={{ marginBottom: '20px' }}>
        <input
          type="text"
          value={newTaskTitle}
          onChange={(e) => setNewTaskTitle(e.target.value)}
          placeholder="新しいタスクを入力"
          style={{
            padding: '8px',
            width: '70%',
            marginRight: '10px',
          }}
        />
        <button
          type="submit"
          style={{
            padding: '8px 16px',
            backgroundColor: '#4CAF50',
            color: 'white',
            border: 'none',
            borderRadius: '4px',
            cursor: 'pointer',
          }}
        >
          追加
        </button>
      </form>

      {/* 4. タスク一覧の表示 */}
      <div>
        <h2>タスク一覧</h2>
        {tasks.map((task) => (
          <div
            key={task.id}
            style={{
              border: '1px solid #ccc',
              padding: '10px',
              margin: '10px 0',
              backgroundColor: task.completed ? '#f0f8f0' : '#fff',
            }}
          >
            <span
              style={{
                textDecoration: task.completed ? 'line-through' : 'none',
              }}
            >
              {task.title}
            </span>
            <span
              style={{ marginLeft: '10px', fontSize: '12px', color: '#666' }}
            >
              {task.completed ? '完了' : '未完了'}
            </span>
          </div>
        ))}
      </div>
    </div>
  );
}
```

### コードの解説

1. 状態の定義
```javascript
const [newTaskTitle, setNewTaskTitle] = useState('');
```

> 💡 **状態管理について**
> - 状態とは、コンポーネントが保持するデータのことです
> - `useState`は状態の値と、それを更新する関数のペアを返します
> - 状態が更新されると、Reactは自動的に画面を更新します
>
> より詳しく知りたい方は、[https://ja.react.dev/learn/state-a-components-memory](https://ja.react.dev/learn/state-a-components-memory) を参考にしてください。

2. 入力フィールドに`value={newTaskTitle}`を設定して、状態の値を表示させます
3. ユーザーがテキストボックスに入力すると`change`イベントが発生します。このイベントが発生したときに実行したい処理を`onChange`イベントハンドラに設定します：
```javascript
onChange={(e) => setNewTaskTitle(e.target.value)}
```

> 💡 **イベントハンドリングについて**
> - イベントとは、ユーザーの操作（クリック、入力など）やブラウザの動作（ページ読み込みなど）によって発生する信号です
> - イベントハンドラは、イベントが発生したときに実行される関数です
> - Reactでは、`on`で始まるプロパティ（例：`onChange`、`onClick`）にイベントハンドラを設定します
> - イベントハンドラは、イベントオブジェクト（`e`）を引数として受け取ります。このオブジェクトには、イベントに関する情報（例：入力値、クリック位置など）が含まれています
>
> より詳しく知りたい方は、[MDNのイベントハンドリングの解説](https://developer.mozilla.org/ja/docs/Learn/JavaScript/Building_blocks/Events)を参考にしてください。

4. イベントハンドラ内で`e.target.value`から入力値を取得し、`setNewTaskTitle`で状態を更新します
5. 状態が更新されると、Reactが自動的に入力フィールドの表示を更新します

このように実装することで、フォームの値と状態を常に同期させ、ユーザーの入力に応じて画面を更新できます。
より詳しく知りたい方は、[https://ja.react.dev/learn/reacting-to-input-with-state](https://ja.react.dev/learn/reacting-to-input-with-state) を参考にしてください。

### よくある問題と解決方法

**タスクが追加されない場合**
- `useState` が正しくインポートされているか確認
- フォームの送信イベントが正しく処理されているか確認
- コンソールにエラーが表示されていないか確認

**入力フィールドが更新されない場合**
- `onChange` イベントハンドラが正しく設定されているか確認
- 状態の更新関数が正しく呼び出されているか確認

### 🔍 動作確認

実装した機能が正しく動作するか確認してみましょう：

import ChecklistItem from '../../../components/ChecklistItem.jsx';

<div>
  <ChecklistItem client:load id="step4-point1">
    新しいタスクを入力できる
  </ChecklistItem>
  <ChecklistItem client:load id="step4-point2">
    追加ボタンをクリックするとタスクが追加される
  </ChecklistItem>
  <ChecklistItem client:load id="step4-point3">
    タスク追加後に入力フィールドがクリアされる
  </ChecklistItem>
  <ChecklistItem client:load id="step4-point4">
    空のタスクは追加されない
  </ChecklistItem>
</div>

### 🎯 理解度チェッククイズ

以下の質問に答えて、学習内容を確認しましょう！

1. **Reactで状態を管理するために使用するフックは？**

   - A: `useEffect`
   - B: `useState`
   - C: `useContext`
   - D: `useReducer`

   <details>
   <summary>答えを見る</summary>

   **答え: B: `useState`**
   - `useState` はコンポーネント内で状態を管理するための基本的なフックです
   - 状態の値と、それを更新する関数のペアを返します
   </details>

2. **フォームの送信を防止するために使用するメソッドは？**

   - A: `stopPropagation()`
   - B: `preventDefault()`
   - C: `stopImmediatePropagation()`
   - D: `cancelBubble()`

   <details>
   <summary>答えを見る</summary>

   **答え: B: `preventDefault()`**
   - `preventDefault()` はイベントのデフォルトの動作を防止します
   - フォームの送信時には、ページのリロードを防ぐために使用します
   </details>

3. **入力フィールドの値が変更された時に発生するイベントは？**

   - A: `onClick`
   - B: `onChange`
   - C: `onSubmit`
   - D: `onInput`

   <details>
   <summary>答えを見る</summary>

   **答え: B: `onChange`**
   - `onChange` イベントは、入力フィールドの値が変更されるたびに発生します
   - フォームの制御には、このイベントを使用して状態を更新します
   </details>

--- 