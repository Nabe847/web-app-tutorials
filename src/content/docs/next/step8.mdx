---
title: '8: Todoの削除'
pubDate: 2025-06-09
description: 'Next.js の初心者向けチュートリアルです'
author: 'Nabe847'
image:
  url: 'https://docs.astro.build/assets/full-logo-light.png'
  alt: 'Astroのロゴ。'
tags: ['Next.js', 'tutorial']
---

## このステップで学ぶこと

前回はTodoの完了状態を更新する機能を実装しました。  
今回はTodoを削除する機能を実装していきましょう。

1. **配列の要素の削除**
2. **確認ダイアログの表示**
3. **イベントハンドリング**

> 💡 **ヒント**:  
> Webアプリケーションでは、データの削除は慎重に行う必要があります。  
> このステップでは、削除前に確認を取る方法を学びます。

## Todo削除機能の実装

`src/app/todos/page.js` を以下の内容に更新します。

```javascript
'use client';
import { useState } from 'react';
import style from './page.module.css';

export default function Todos() {
  // Todoデータの定義
  const [todos, setTodos] = useState([
    { id: 1, title: '買い物に行く', completed: false },
    { id: 2, title: 'メールを確認する', completed: false },
    { id: 3, title: '資料を作成する', completed: false },
    { id: 4, title: '友達に電話する', completed: false },
    { id: 5, title: '部屋の掃除', completed: false },
  ]);

  // 入力値の状態管理
  const [newTodo, setNewTodo] = useState('');

  // Todo追加処理
  const handleSubmit = (e) => {
    e.preventDefault();
    if (newTodo.trim() === '') return;

    const newId = todos.length > 0 ? Math.max(...todos.map(t => t.id)) + 1 : 1;
    setTodos([...todos, { id: newId, title: newTodo, completed: false }]);
    setNewTodo('');
  };

  // Todoの完了状態を更新する処理
  const handleToggleComplete = (todoId) => {
    setTodos(todos.map(todo =>
      todo.id === todoId
        ? { ...todo, completed: !todo.completed }
        : todo
    ));
  };

  // Todoを削除する処理
  const handleDelete = (todoId) => {
    if (window.confirm('このTodoを削除しますか？')) {
      setTodos(todos.filter(todo => todo.id !== todoId));
    }
  };

  return (
    <section className={style.container}>
      <h1>Todoリスト</h1>
      
      {/* Todo追加フォーム */}
      <form onSubmit={handleSubmit} className={style.form}>
        <input
          type="text"
          value={newTodo}
          onChange={(e) => setNewTodo(e.target.value)}
          placeholder="新しいTodoを入力"
          className={style.input}
        />
        <button type="submit" className={style.button}>追加</button>
      </form>

      {/* Todo一覧 */}
      <div className={style.checkbox}>
        {todos.map(todo => (
          <div key={todo.id} className={style.todoItem}>
            <label className={todo.completed ? style.completed : ''}>
              <input
                type="checkbox"
                checked={todo.completed}
                onChange={() => handleToggleComplete(todo.id)}
              />
              {todo.title}
            </label>
            <button
              onClick={() => handleDelete(todo.id)}
              className={style.deleteButton}
            >
              削除
            </button>
          </div>
        ))}
      </div>
    </section>
  );
}
```

### コードの説明

1. **状態管理の基本**
   - `useState` フックを使って、データを保存する場所（状態）を作ります
   - `todos`: Todo一覧を保存する配列
   - `newTodo`: 入力フォームの文字を保存する変数

2. **Todoを削除する仕組み**
   ```javascript
   const handleDelete = (todoId) => {
     if (window.confirm('このTodoを削除しますか？')) {
       setTodos(todos.filter(todo => todo.id !== todoId));
     }
   };
   ```
   - `window.confirm()`: 削除する前に確認ダイアログを表示します
   - `filter()`: 配列から条件に合う要素だけを選び出します
   - `todo.id !== todoId`: 削除するTodo以外を選び出します
   - `setTodos()`: 更新されたTodo一覧を保存します

3. **削除ボタンの基本**
   - `onClick`: ボタンがクリックされたときの処理を指定します
   - `className`: ボタンの見た目を指定します

## スタイルの更新

`src/app/todos/page.module.css` に以下のスタイルを追加します。

```css
.todoItem {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
}

.deleteButton {
  padding: 0.3em 0.8em;
  border: none;
  border-radius: 3px;
  background-color: #dc3545;
  color: white;
  cursor: pointer;
}

.deleteButton:hover {
  background-color: #c82333;
}
```

## 🔍 確認

実装した機能が正しく動作しているか確認しましょう：

import ChecklistItem from '../../../components/ChecklistItem.jsx';

<div>
  <ChecklistItem client:load id="step8-point1">
    削除ボタンをクリックすると確認ダイアログが表示される
  </ChecklistItem>
  <ChecklistItem client:load id="step8-point2">
    確認後にTodoが削除される
  </ChecklistItem>
  <ChecklistItem client:load id="step8-point3">
    キャンセルした場合はTodoが削除されない
  </ChecklistItem>
</div>

## よくある問題と解決方法

**削除が機能しない**
- `handleDelete` 関数が正しく呼び出されているか確認
- 確認ダイアログの表示が正しく機能しているか確認
- `filter` メソッドの条件が正しいか確認

**スタイルが適用されない**
- CSSクラス名が正しく設定されているか確認
- スタイルの優先順位が正しいか確認

## 🎯 理解度チェック

以下の質問に答えて、学習内容を確認しましょう！

1. **配列から特定の要素を削除するために使用するメソッドは？**

   - A: `forEach()`
   - B: `map()`
   - C: `filter()`
   - D: `reduce()`

<details>
<summary>答えを見る</summary>

   **答え: C: `filter()`**
   - `filter()` は条件に合う要素だけを抽出して新しい配列を作成します
   - このステップでは、特定のID以外のTodoを抽出するために使用しています
</details>

2. **確認ダイアログを表示するために使用するメソッドは？**

   - A: `window.alert()`
   - B: `window.prompt()`
   - C: `window.confirm()`
   - D: `window.dialog()`

<details>
<summary>答えを見る</summary>

   **答え: C: `window.confirm()`**
   - `window.confirm()` はユーザーに確認を求めるダイアログを表示します
   - このステップでは、Todoの削除前に確認を取るために使用しています
</details>

## 📝 まとめ

このステップでは以下について学びました。

- **データの削除**
  - 配列からの要素の削除
  - `filter` メソッドの使用
  - 確認ダイアログの表示

- **イベントハンドリング**
  - 削除ボタンのクリックイベント
  - 確認ダイアログの処理

- **UI/UX**
  - 削除前の確認
  - 視覚的なフィードバック
  - エラー防止
